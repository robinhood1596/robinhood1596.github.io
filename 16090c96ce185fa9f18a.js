"use strict";var videoStream=null;function insertImageToSlide(e){console.log("Inserting image."),Office.context.document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Image},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Error inserting image: "+e.error.message):console.log("Image inserted successfully.")}))}function capturePhoto(){var e=document.querySelector("video"),t=document.querySelector("canvas");e||(e=document.createElement("video"),document.body.appendChild(e)),t||(t=document.createElement("canvas"),document.body.appendChild(t));var o=document.getElementById("capturePhotoButton");o?(videoStream||navigator.mediaDevices.getUserMedia({video:!0}).then((function(t){videoStream=t,e.srcObject=t,e.play()})).catch((function(e){console.error("Error accessing the camera",e)})),o.onclick=function(){if(videoStream){t.width=1920,t.height=1080;var o=t.getContext("2d");if(o){o.drawImage(e,0,0,1920,1080);var n=t.toDataURL("image/png").split(",")[1];console.log("Captured image data URL:",n),insertImageToSlide(n),o.clearRect(0,0,t.width,t.height)}else console.error("Failed to get canvas context.")}else console.error("No video stream available")}):console.error("Capture button not found")}function stopCamera(){if(videoStream){videoStream.getTracks().forEach((function(e){e.stop()})),videoStream=null;var e=document.querySelector("video");e&&e.remove();var t=document.querySelector("canvas");t&&t.remove()}}Office.onReady((function(){var e=document.getElementById("capturePhotoButton");e&&e.addEventListener("click",capturePhoto);var t=document.createElement("button");t.textContent="Stop Camera",document.body.appendChild(t),t.addEventListener("click",stopCamera)}));