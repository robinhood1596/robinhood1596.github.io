!function(){"use strict";var e={81192:function(e,t,o){e.exports=o.p+"16090c96ce185fa9f18a.js"}},t={};function o(n){var c=t[n];if(void 0!==c)return c.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}o.m=e,o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var c=n.length-1;c>-1&&(!e||!/^http(s?):/.test(e));)e=n[c--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e}(),o.b=document.baseURI||self.location.href,function(){let e=null;function t(){let t=document.querySelector("video"),o=document.querySelector("canvas");t||(t=document.createElement("video"),document.body.appendChild(t)),o||(o=document.createElement("canvas"),document.body.appendChild(o));const n=document.getElementById("capturePhotoButton");n?(e||navigator.mediaDevices.getUserMedia({video:!0}).then((function(o){e=o,t.srcObject=o,t.play()})).catch((function(e){console.error("Error accessing the camera",e)})),n.onclick=function(){if(e){const e=1920,n=1080;o.width=e,o.height=n;const c=o.getContext("2d");if(c){c.drawImage(t,0,0,e,n);const r=o.toDataURL("image/png").split(",")[1];console.log("Captured image data URL:",r),function(e){console.log("Inserting image."),Office.context.document.setSelectedDataAsync(e,{coercionType:Office.CoercionType.Image},(function(e){e.status===Office.AsyncResultStatus.Failed?console.error("Error inserting image: "+e.error.message):console.log("Image inserted successfully.")}))}(r),c.clearRect(0,0,o.width,o.height)}else console.error("Failed to get canvas context.")}else console.error("No video stream available")}):console.error("Capture button not found")}function o(){if(e){e.getTracks().forEach((function(e){e.stop()})),e=null;const t=document.querySelector("video");t&&t.remove();const o=document.querySelector("canvas");o&&o.remove()}}Office.onReady((function(){const e=document.getElementById("capturePhotoButton");e&&e.addEventListener("click",t);const n=document.createElement("button");n.textContent="Stop Camera",document.body.appendChild(n),n.addEventListener("click",o)}))}(),new URL(o(81192),o.b)}();
//# sourceMappingURL=taskpane.js.map